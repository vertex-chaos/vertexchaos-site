---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Card from "../../components/Card.astro";
import Tag from "../../components/Tag.astro";
import { site } from "../../config/site";
import { getCollection } from "astro:content";

const entries = (await getCollection("case-studies"))
  .sort((a, b) => (b.data?.date?.valueOf?.() ?? 0) - (a.data?.date?.valueOf?.() ?? 0));
---

<BaseLayout title={`Work | ${site.brand}`} description="Generalized case studies with the parts clients care about: problem, approach, result.">
  <div class="flex items-end justify-between gap-6">
    <div>
      <p class="text-sm text-slate-500">workportfolio</p>
      <h1 class="mt-2 text-4xl font-bold tracking-tight text-slate-900">Work</h1>
      <p class="mt-4 max-w-2xl text-slate-600">
        Generalized case studies with the parts clients care about: problem, approach, result.
      </p>
    </div>
  </div>

  <div class="mt-10 grid gap-6">
    {entries.map((entry) => {
      const d = entry.data ?? {};
      const href = `/work/${entry.slug}/`;
      return (
        <Card>
          <div class="flex items-start justify-between gap-6">
            <div class="min-w-0">
              <a class="text-lg font-semibold text-slate-900 hover:underline" href={href}>
                {d.title ?? entry.slug}
              </a>
              {d.summary && <p class="mt-2 text-slate-600">{d.summary}</p>}

              <div class="mt-3 flex flex-wrap gap-2">
                {Array.isArray(d.tags) && d.tags.map((t) => <Tag label={t} />)}
              </div>
            </div>

            <div class="shrink-0 text-sm text-slate-500">
              {d.client && <div class="text-right">{d.client}</div>}
            </div>
          </div>
        </Card>
      );
    })}
  </div>
</BaseLayout>